<?php

/**
 * @file
 * OpenEuropa Editorial module.
 */

declare(strict_types = 1);

use Drupal\Core\Form\FormStateInterface;
use Drupal\Core\Url;

/**
 * Implements hook_field_widget_form_alter().
 */
function oe_editorial_field_widget_form_alter(&$element, FormStateInterface $form_state, $context) {
  // We add an after build method so we can alter the Url of the help link.
  if ($element['#type'] == 'text_format') {
    $element['#after_build'][] = '_oe_editorial_alter_textarea_help';
  }
}

/**
 * After build callback to alter the Url of the help link on text areas.
 */
function _oe_editorial_alter_textarea_help($form_element, FormStateInterface $form_state) {
  if (isset($form_element['format'])) {
    $form_element['format']['help']['about']['#url'] = Url::fromRoute('filter.tips', ['filter_format' => $form_element['#format']]);
  }
  return $form_element;
}
